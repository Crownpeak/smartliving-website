import de.espirit.firstspirit.webedit.server.ClientScriptOperation;
import de.espirit.firstspirit.agency.OperationAgent;


defaults = context.getScript().getFormDefaults();

configuredUrl = context.project.getWebeditPreviewUrl();
if (configuredUrl != null) {
	defaults.get(null, "url").set(configuredUrl + " ");
}

formData = context.showForm(false);

if (formData == null) {
    return null;
}

url = formData.get(null, "url").get().trim();
script = "window.CxtHost.client.shadowRoot.querySelector('cc-preview').shadowRoot.querySelector('#previewContent').setAttribute('src', '" + url + "');";

operationAgent = context.requireSpecialist(OperationAgent.TYPE);
scriptOperation = operationAgent.getOperation(ClientScriptOperation.TYPE);

scriptOperation.perform(script, false);
